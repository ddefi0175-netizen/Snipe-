<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes" />
  <meta name="description" content="Real-time trading platform with live chat, wallet integration, and admin control. Support for 11 wallet providers." />
  <meta name="theme-color" content="#0f172a" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <!-- Content Security Policy - allows scripts from trusted sources -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://vercel.live https://*.firebaseapp.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com data:; connect-src 'self' https://*.firebaseio.com https://*.firebaseapp.com https://vercel.live https://api.github.com https://www.google-analytics.com https://analytics.google.com; img-src 'self' data: https:; frame-ancestors 'self';" />
  <title>OnchainWeb - Real-Time Trading Platform</title>
  
  <!-- Google Consent Mode v2 - Initialize before any analytics scripts -->
  <script>
    // Initialize dataLayer for gtag
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    
    // Set default consent state (denied until user accepts)
    gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_personalization': 'denied',
      'ad_user_data': 'denied',
      'functionality_storage': 'granted',
      'security_storage': 'granted'
    });
    
    // Check for saved consent preferences and apply immediately
    try {
      var saved = localStorage.getItem('user_consent_preferences');
      if (saved) {
        var parsed = JSON.parse(saved);
        var thirteenMonths = 13 * 30 * 24 * 60 * 60 * 1000;
        if (Date.now() - parsed.timestamp <= thirteenMonths) {
          gtag('consent', 'update', parsed.consent);
        }
      }
    } catch (e) {
      console.error('Failed to load consent preferences:', e);
    }
  </script>
  <!-- GitHub Pages SPA redirect handler -->
  <script type="text/javascript">
    (function (l) {
      if (l.search[1] === '/') {
        var decoded = l.search.slice(1).split('&').map(function (s) {
          return s.replace(/~and~/g, '&')
        }).join('?');
        window.history.replaceState(null, null,
          l.pathname.slice(0, -1) + decoded + l.hash
        );
      }
    }(window.location))
  </script>
</head>

<body>
  <div id="root">
    <!-- Loading skeleton to prevent blank screen until JS loads -->
    <div style="
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0a0a0f 100%);
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    ">
      <div style="text-align: center;">
        <div style="
          width: 50px;
          height: 50px;
          border: 3px solid rgba(124, 58, 237, 0.3);
          border-top: 3px solid #7c3aed;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 16px;
        "></div>
        <p style="margin: 0; opacity: 0.8;">Loading OnchainWeb...</p>
      </div>
      <style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      </style>
    </div>
  </div>
  <script type="module" src="/src/main.jsx"></script>
</body>

</html>
