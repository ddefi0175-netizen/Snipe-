name = "snipe-onchainweb"
main = "workers/index.js"
compatibility_date = "2024-01-01"
# Account ID should be set via environment variable or wrangler secret
# Set via: wrangler secret put CLOUDFLARE_ACCOUNT_ID
account_id = "eb568c24da7c746c95353226eb665d00"

[[kv_namespaces]]
binding = "CACHE"
# KV Namespace ID - should be created via wrangler kv:namespace create
id = "488840361a874877b2b54506b15f746a"
preview_id = "488840361a874877b2b54506b15f746a"

[[r2_buckets]]
binding = "STORAGE"
# R2 Bucket - should be created via wrangler r2 bucket create
bucket_name = "onchainweb"
preview_bucket_name = "onchainweb"

[vars]
# Non-sensitive configuration variables
FIREBASE_PROJECT_ID = "onchainweb-b4b36"
FIREBASE_DATABASE_URL = "https://onchainweb-b4b36-default-rtdb.asia-southeast1.firebasedatabase.app"
# SECURITY NOTE: Sensitive tokens should be set via wrangler secrets:
# wrangler secret put TELEGRAM_BOT_TOKEN
# wrangler secret put FIREBASE_PRIVATE_KEY
# For now, placeholder values - REPLACE WITH SECRETS IN PRODUCTION
TELEGRAM_BOT_TOKEN = "SET_VIA_WRANGLER_SECRET"
TELEGRAM_USERNAME = "goblin_niko4"
# R2 public URL - set to your custom domain or R2 public URL
R2_PUBLIC_URL = "https://storage.onchainweb.app"
# Allowed CORS origins (comma-separated)
ALLOWED_ORIGINS = "https://onchainweb.pages.dev,https://www.onchainweb.app"

[build]
command = "npm install && npm run build"

[env.production]
name = "snipe-workers-production"

# Cloudflare Pages configuration
pages_build_output_dir = "Onchainweb/dist"

# D1 Database binding (legacy - kept for compatibility)
[[d1_databases]]
binding = "DB"
database_name = "onchainweb"
database_id = "e3f277bd-092a-41d6-a477-4521200c79fe"

# Observability settings
[observability]
enabled = true
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true

[observability.traces]
enabled = true
persist = true
head_sampling_rate = 1

# ============================================
# Routes Configuration
# ============================================
# routes = [
#   { pattern = "api.yourdomain.com/api/*", zone_name = "yourdomain.com" }
# ]
